!function(){function e(e){var t=e.parentNode.getAttribute("chatId"),i=m[t],n=i.techId;n?$.page("chat&techId="+(i.techId||"")+($.$.clubID?"":"&clubId="+i.clubId)):($.$.easemob.currChatTech={chatId:t,name:i.name,header:i.header,avatar:i.avatar,clubId:i.clubId,clubName:"",techId:"",inviteCode:"",no:"",appointment:"n",phoneAppointment:"n",telephone:"",chatName:"",chatHeader:""},$.page("chat&techId="+(i.techId||"")+($.$.clubID?"":"&clubId="+i.clubId)))}function t(e){return e.replace(n,function(){return c[arguments[0]]||arguments[0]})}var i,n,a="",d=$("#content>div.list")[0],s=$("#title>div:nth-of-type(1)>div"),l=$("#_clubMenu>div:nth-of-type(2)>div:nth-of-type(1)>i",!0),r=$("#_publicMenu>div:nth-of-type(2)>div:nth-of-type(1)>i",!0),c={"/::O":"/大笑","/::Y":"/坏笑","/::B":"/害羞","/::A":"/色","/::C":"/晕","/::D":"/红心","/::X":"/心碎了","/::Z":"/握手","/::F":"/抱拳","/::E":"/花","/::T":"/花谢了","/::P":"/示爱","/::G":"/亲亲","/::H":"/大哭","/::I":"/可怜","/::J":"/生气","/::K":"/微笑","/::L":"/冷汗","/::M":"/困","/::N":"/调皮","/::Q":"/敲打","/::R":"/疑问","/::S":"/猪头","/::U":"/汽水","/::V":"/西瓜","/::W":"/鼓掌","/::a":"/大拇指","/::b":"/剪刀手"};n=new RegExp("/::[A-Zab]+","g");var v,o,h=$("#content>div.nullData")[0],m=$.getSessionList(!1,!0),g=[];for(o in m)m[o].clubId!=$.$.clubID&&$.$.clubID||g.push({id:o,time:m[o].time});g.sort(function(e,t){return e.time>t.time?-1:1});var p=0;for(v=0;v<g.length;v++)i=m[g[v].id],i.name&&(a+="<div chatId='"+g[v].id+"' data-msg-num='"+i["new"]+"' class='list_"+g[v].id+"'>                                <div style='background-image: url("+i.header+")'></div>                                <div>                                    <div>"+i.name+(i.no&&i.no.length>0?"<span><span>[</span>"+i.no+"<span>]</span></span>":"")+"</div>                                    <div>"+t(i.msg.data.replace(/<br>|<br\/>/g,""))+"</div>                                    <div>"+$.formatMsgTime(i.time)+"</div>                                    <div "+(0==i["new"]?"class='hidden'":"")+">"+i["new"]+"</div>                                </div><div class='delete-msg'>删除记录</div>                         </div>",p+=i["new"]);d.innerHTML=a,0==a.length&&(h.style.display="block",s.Hide()),p>0&&(l.Text(p),l.CSS({visibility:"hidden"}),r.Text(p),r.CSS({visibility:"hidden"})),$.refreshMessageList=function(e){var i,n=d.querySelector("div.list_"+e),a=m[e];if(n){n.children[1].children[1].innerHTML=t(a.msg.data.replace(/<br>|<br\/>/g,"")),n.children[1].children[2].innerHTML=$.formatMsgTime(a.time),i=n.children[1].children[3],i.className="",i.innerHTML=a["new"],n.dataset.msgNum=a["new"];var s=d.children[0];s!=n&&d.insertBefore(n,s)}else"block"==h.style.display&&(h.style.display="none"),n=document.createElement("div"),n.className="list_"+e,n.setAttribute("chatId",e),n.dataset.msgNum=a["new"],n.innerHTML="<div style='background-image: url("+a.header+")'></div>                                            <div>                                                <div>"+a.name+(a.no&&a.no.length>0?"<span><span>[</span>"+a.no+"<span>]</span></span>":"")+"</div>                                                <div>"+t(a.msg.data.replace(/<br>|<br\/>/g,""))+"</div>                                                <div>"+$.formatMsgTime(a.time)+"</div>                                                <div>"+a["new"]+"</div>                                            </div><div class='delete-msg'>删除记录</div>",0==d.children.length?d.appendChild(n):d.insertBefore(n,d.children[0])},$("#_orderTech>div.message",!0).ClassClear("new"),$.pageSwitch(!0,!0),$("#content>div.list").Delegate("click",">div>div:nth-of-type(1),>div>div:nth-of-type(2)",function(t,i){e(i)}),s.Event("click",function(e,t){var i=$(t);i.ClassHave("edit-title")?($(".delete-msg").Class("active"),i.ClassClear("edit-title"),i.Class("complete-title"),i.Text("完成")):(i.ClassClear("complete-title"),i.Class("edit-title"),$(".delete-msg").ClassClear("active"),i.Text("编辑"))}),$("#content>div.list").Delegate("click",".delete-msg",function(e,t,i){e.preventDefault();var n=$(t.parentNode),a=n.Attr("chatid"),c=$.$.easemob;$.getMsgList(a),c.sessionList[a]&&(delete c.sessionList[a],$.localStorage($.$.userID+"_SessionList",JSON.stringify(c.sessionList))),c.msgList[a]&&(delete c.msgList[a],$.localStorageClear($.$.userID+"_MsgList_"+a)),d.removeChild(n[0]),0==$(d).Children().length&&(h.style.display="block",s[0].click());var v=l.Text()-parseInt(n[0].dataset.msgNum),o=r.Text()-parseInt(n[0].dataset.msgNum);l.Text(v),0==v&&l.CSS({visibility:"hidden"}),r.Text(o),0==o&&r.CSS({visibility:"hidden"})})}();