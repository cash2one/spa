!function(){function e(){s[0]&&s[1]&&s[2]?o.Class("active"):o.ClassClear("active"),s[0]?r.CSS("display","none"):r.CSS("display","block")}var a=$("#recover-tel"),t=$("#recover-authCode"),i=$("#send-authCode-btn"),n=$("#recover-password"),o=$("#recover-password-btn"),s=[0,0,0],r=$("#content>div>div:nth-of-type(3)");a.Verify("tel",function(a){s[0]=a,e()}),t.Verify("authcode",function(a){s[1]=a,e()}),n.Verify("password",function(a){s[2]=a,e()}),window.loginInfo&&window.loginInfo.username&&(a[0].value=window.loginInfo.username,/^1[34578]\d{9}$/.test(a[0].value)&&(s[0]=!0,e())),i.Event("click",function(e,t){if(!i.ClassHave("disabled")&&!i.ClassHave("pause"))return s[0]?void $.ajax({url:"../api/v1/user/checkLoginName",isReplaceUrl:!0,type:"post",data:{loginName:a.Value()},success:function(e){if("-1"==e.toString())return $.tipShow("用户尚未注册！");i.Class("pause"),i.Text("重新发送(60s)");var t,n=60,o=setInterval(function(){0==--n?(clearInterval(o),t=i.Attr("data-repeat-count")-1,i.Attr("data-repeat-count",t),i.ClassClear("pause"),i.Text("获取验证码"),0==t&&i.Class("disabled")):i.Text("重新发送("+n+"s)")},1e3);$.ajax({url:"../api/v1/icode",isReplaceUrl:!0,type:"get",data:{mobile:a.Value()}})}}):$.tipShow("请输入正确的手机号码！")}),o.Click(function(){o.ClassHave("active")&&$.ajax({url:"../api/v1/user/checkLoginName",isReplaceUrl:!0,type:"post",data:{loginName:a.Value()},success:function(e){return"-1"==e.toString()?$.tipShow("无此用户！"):void $.ajax({url:"../api/v1/user/resetPassword",isReplaceUrl:!0,type:"post",data:{username:a.Value(),code:t.Value(),password:n.Value()},success:function(e){$.tipShow("密码修改成功！");var t={username:a.Value(),isBindWeixin:!1,password:n.Value()};$.localStorage("con-login-param",JSON.stringify(t)),$.page("confirmLogin")},error:function(e,a){$.tipShow(e)}})}})}),$.pageSwitch(!0,!1)}();