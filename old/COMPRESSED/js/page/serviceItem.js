!function(){function t(t){if("N"==t.appointment&&"Y"==t.phoneAppointment){var i="";if(""!=t.telephone)for(var e=0,n=t.telephone.split(","),d=n.length;e<d;e++)i+="<div>"+n[e]+"</div>";$("#telDetail>div").Html(i+"<div>取消</div>"),C.Event("touchmove",function(t){t.preventDefault()},!1),C.Click(function(t,i){t.target==i&&C.ClassClear()}),c=$("#telDetail>div>div"),v=c.Remove(c.length-1),c.Click(function(t,i){location.href="tel:"+i.innerHTML}),v.Click(function(){C.ClassClear()}),$("#confirmBtn").Click(function(){""==t.telephone?$.tipShow("暂无电话"):C.Class("active")})}else $("#confirmBtn").Click(function(){if("on"!=t.payAppointment||$.$.ua.isWX){var i=1==l?$("#content>div.scroll_content>div:nth-of-type("+(p+1)+")").Attr("hh"):o[p].id,e=$("#content>div.scroll_content>div:nth-of-type("+(p+1)+")>div>div:nth-of-type(3)>div.selected").Attr("hh");$.login("confirmOrder&itemId="+i+(e?"&techId="+e:"")+"&backPublic=true",!1,!0,!0)}else $.checkAccessMenu("confirmOrder")&&$.tipShow("【此会所需支付预约，请在微信客户端中打开】")})}function i(i,c){$.ajax({url:"service/item",data:{top:0,index:c,itemId:i,pageSize:5},success:function(v){if("200"!=v.statusCode)return $.tipShow(v.msg||"数据请求失败！"),$.pageCancel();if(!o){if(0==v.pageCount)return u.Class("nullData"),$.pageSwitch(!0,!1);e(v)}t(v.respData),s=v.respData.itemIndex,v=v.respData.serviceItems;var l;for(a=0;a<v.length;a++)if(v[a].id==i){l=a;break}for(l||0==c||c==-1&&(l=v.length),l=s-l,a=0;a<v.length;a++)o[a+l]||(o[a+l]={status:0,id:v[a].id,dataObj:v[a]});for(a=0;a<o.length;a++)o[a]&&0==o[a].status&&($("#content>div.scroll_content>div:nth-of-type("+(a+1)+")").Html(n(o[a].dataObj)),$("div#content>div.scroll_content>div:nth-of-type("+(a+1)+") div.list").Click(function(t,i){var e=t.timeStamp||(new Date).getTime();m?(e-m>350&&d(i),m=e):(m=e,d(i))}),o[a].status=1);0==c&&$.pageSwitch(!0,!1),$("#content>div>div>div>div:nth-of-type(1)>div:nth-of-type(1)").DivBackgroundCacheBack(),$("#content>div>div>div>div:nth-of-type(2) img").ImgSrcCacheBack()}})}function e(t){o=[],o.length=t.pageCount;for(var e="",n=0;n<o.length;n++)e+="<div></div>";g.Html(e),p=t.respData.itemIndex,$.scroll({content:f,contentX:g[0],indexX:p,endX:function(t){var e=t-p>0?1:-1;p=t,$.param("id",o[t].id),(1==e&&p<o.length-1&&!o[p+1]||e==-1&&p>0&&!o[p-1])&&i(o[t].id,e)}})}function n(t){var i,e=1==l?'<div hh="'+t.id+'">':"";if(e+='<div>                            <div>                                <div imageCache="'+(t.imageUrl||$.$.defaultService)+'"></div>                                <div>                                    <div>'+t.name+"</div>                                    <div"+(t.price?"":' style="display:none;"')+">                                        <div></div>                                        <div>"+$.formatPrice(t.price,t.duration,t.durationUnit)+"</div>                                    </div>                                    <div"+(t.pricePlus?"":' class="none"')+">加钟"+$.formatPrice(t.pricePlus,t.durationPlus,t.durationUnitPlus)+"</div>                                </div>                            </div>                            <div><div><div></div>项目说明</div>"+(t.description||"").replace(/src/g,"imageCache")+"</div>",t.techs&&t.techs.length>0){for(e+='<div>                                <div class="title"><div></div>选择技师</div>',i=0;i<t.techs.length;i++)e+='<div class="list" hh="'+t.techs[i].id+'">                                        <div></div>                                        <div style="background-image: url('+(t.techs[i].avatarUrl||$.$.defaultHeader)+')"></div>                                        <div>                                            <div><div>'+($.$.ua.isFirefox&&t.techs[i].name.length>3?t.techs[i].name.substr(0,3)+"...":t.techs[i].name)+"</div><div>[<span>"+(t.techs[i].serialNo||"")+"</span>]</div> </div>                                            <div>"+(t.techs[i].description||"这个技师很懒，没有填写个人简介...")+'</div>                                            <div><div><div style="width:'+t.techs[i].star+'%"></div></div><span>'+t.techs[i].commentCount+"评论</span></div>                                        </div>                                    </div>";e+="</div>"}return e+="</div>",1==l&&(e+="</div>"),e}function d(t){var t=$(t);t.ClassHave("selected")?t.ClassClear("selected"):($("#content>div.scroll_content>div:nth-of-type("+(p+1)+")>div>div:nth-of-type(3)>div.list").ClassClear("selected"),t.Class("selected"))}var a,c,v,o,s,l=$.param("top")||"",r="",h=$.param("id"),p=0,u=$("#content"),f=$("#content")[0],m=null,g=$("#content>div"),C=$("#telDetail");1==l?$.ajax({url:"service/item",data:{top:1},success:function(i){if("200"!=i.statusCode)return $.tipShow(i.msg||"数据请求失败！"),$.pageCancel();for(t(i.respData),i=i.respData.serviceItems,a=0;a<i.length;a++)r+=n(i[a]),h==i[a].id&&(p=a);""==r?u.Class("nullData"):g.Html(r),$.scroll({content:f,contentX:g[0],indexX:p,endX:function(t){p=t,$.param("id",i[t].id)}}),$("div.list").Click(function(t,i){var e=t.timeStamp||(new Date).getTime();m?(e-m>350&&d(i),m=e):(m=e,d(i))}),$.pageSwitch(!0,!1),$("#content>div>div>div>div:nth-of-type(1)>div:nth-of-type(1)").DivBackgroundCacheBack(),$("#content>div>div>div>div:nth-of-type(2) img").ImgSrcCacheBack()}}):i(h,0)}();