!function(){var e,t,i,a=$.param("id"),o=$(".can-use"),d=$(".used"),n="";return a?($(".ope-wrap>div").Click(function(e,t){var i=t.getAttribute("data-index");$(".ope-wrap>div").ClassClear("active"),t.classList.add("active"),0==i?(o.Show(),d.Hide()):(o.Hide(),d.Show())}),$(".service-item").Click(function(){$.page("onceCardDetail&id="+n)}),void $.ajax({url:"../api/v2/club/once_card/order/detail",isReplaceUrl:!0,data:{orderId:a},success:function(a){if(200==a.statusCode){a=a.respData;var c=a.order;$(".title>div").CSS("background-image","url("+(c.clubImageUrl||$.$.defaultClubLogo)+")"),$(".title>span").Text(c.clubName),$(".title").Click(function(){$.$.clubID?$.page("home"):location.href=location.origin+"/spa-manager/spa2/?club="+c.clubId+"#home"}),$("#footer").Click(function(){$.$.clubID?$.page("discountMall"):location.href=location.origin+"/spa-manager/spa2/?club="+c.clubId+"#discountMall"}),$(".service-item>div:nth-of-type(1)").CSS("background-image","url("+(c.imageUrl||$.$.defaultService)+")"),$(".service-item>div:nth-of-type(2)").Text(c.itemName),$(".service-item>div:nth-of-type(3)>span").Text((c.amount/100).toFixed(2)),$(".service-item>div:nth-of-type(4)").Text(c.useEndTime?"有效期至："+c.useEndTime:"长期有效"),2==c.status&&($(".ope-wrap>div:nth-of-type(1)")[0].innerHTML="失效（<span></span>）");var l=c.totalCount-c.usedCount;$(".ope-wrap>div:nth-of-type(1)>span").Text(l),$(".ope-wrap>div:nth-of-type(2)>span").Text(c.usedCount);var s,u,r,p="",v="",m=a.couponList,l=0,h=0;for(e=0;e<m.length;e++)s=m[e],r="Y"==s.couponSettled,r?h++:l++,0==e&&(n=s.actId),u="<div class='coupon'>                                <div>券"+(r?h:l)+"</div>                                <div no='"+s.couponNo+"'></div>                                <div>核销码：<span>"+$.spaceStr(s.couponNo,!1,4)+"</span></div>"+(r?"<div>使用时间："+s.modifyDate+"</div>":"")+"                             </div>",r?v+=u:p+=u;if(0==l)o.Html("<div class='no-data'>已经全部用完啦~</div>");else for(o.Html("<div class='item'>                                                    <h4>"+c.itemName+"券</h4>"+p+"                                                </div>"),t=$(".can-use>div.item>div.coupon>div:nth-of-type(2)"),e=0;e<t.length;e++)i=new QRCode(t[e],{width:430,height:430}),i.makeCode(t[e].getAttribute("no"));if(0==c.usedCount)d.Html("<div class='no-data'>还没有使用记录~</div>");else for(d.Html("<div class='item'>                                                    <h4>"+c.itemName+"券</h4>"+v+"                                                </div>"),t=$(".used>div.item>div.coupon>div:nth-of-type(2)"),e=0;e<t.length;e++)i=new QRCode(t[e],{width:430,height:430}),i.makeCode(t[e].getAttribute("no"));$.pageSwitch()}}})):($.tipShow("页面缺少访问参数！"),$.pageCancel())}();