!function(){function e(){var e={username:a.Value(),password:"",usertype:"user",clubId:$.$.clubID||$.$.loginChannelClubID||"",code:"",scope:"snsapi_base",oldUserId:$.$.userID,oldChatId:$.$.easemob.userId};("9358"==$.$.sessionType||$.$.ua.isWX)&&(e.loginChanel=$.$.loginChanel,e.openId=$.$.openId,e.wxNickName=$.$.nickName,e.wxHeadimgurl=$.$.headerImgUrl,e.isBindWeixin=!0),$.ajax({url:"../api/v1/user/login",isReplaceUrl:!0,type:"post",data:e,success:function(a){window.loginInfo=e,2==a.statusCode?($.localStorageClear("user-login-param"),$.localStorage("user-register-param",JSON.stringify(e)),$.page("register")):"935801"==a.statusCode?($.localStorage("user-login-param",JSON.stringify(e)),$.getOauthCode("","9358","9358_login","base")):1==a.statusCode&&($.localStorageClear("user-login-param"),$.localStorage("con-login-param",JSON.stringify(e)),$.page("confirmLogin"))}})}var a=$("#bindTel"),s=$("#sure-btn"),i=$("#bindPhoneDialog");a.Verify("tel",function(e){e?s.Class("active"):s.ClassClear("active")}),s.Click(function(){s.ClassHave("active")&&$.ajax({url:($.$.clubID?"../":"")+"../wx/current/check_bind",type:"get",success:function(s){200==s.statusCode?"Y"==s.msg?($.tipShow("当前用户是已绑定状态。"),$.$.is_telphone_user=!0,$.localStorage("is_telphone_user",!0),$.cookie("is_telphone_user",!0),$.page($.$.loginUrl)):$.ajax({url:($.$.clubID?"../":"")+"../wx/check_bind",type:"get",data:{phoneNum:a.Value()},success:function(a){200==a.statusCode?1==a.respData?i.Class("active"):e():$.tipShow(a.msg||"检查绑定状态失败。")}}):$.tipShow(s.msg||"检查绑定状态失败。")}})}),i.Delegate("click","a.cancel-btn",function(e,a){i.ClassClear("active")}).Delegate("click","a.sure-btn",function(a,s){e()}),$.pageSwitch()}();